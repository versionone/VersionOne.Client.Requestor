<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link href="Content/jquery.mobile-1.2.0.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="versionOne.requestor.css" />
    <link rel="stylesheet" href="Content/toastr.css" />
    <script src="Scripts/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.mobile-1.2.0.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.validVal-4.2.5-packed.js" type="text/javascript"></script>
    <script src="Scripts/jquery.validVal-customValidations.js" type="text/javascript"></script>
    <script src="Scripts/jsrender.js" type="text/javascript"></script>
    <script src="Scripts/toastr.js" type="text/javascript"></script>    
    <script type="text/javascript" src="versionOne.requestor.js"></script>
    <script type="text/javascript">
$(document).ready(function () {
    // var host = "http://platform-dev";
    // var service = "http://platform-dev/CustomerTest/rest-1.v1/Data/";
    
    var host = "http://localhost";
    var service = "http://localhost/VersionOne.Web/rest-1.v1/Data/";
    var versionOneAuth = "admin:admin";
    var showDebugMessages = false;

    var serviceGateway = false;
    //var serviceGateway: "http://localhost/v1requestorGateway"
    
    var options = {
        showDebug: showDebugMessages,
        projectName: "'System (All Projects)'",
        host: host,
        service: service,
        serviceGateway: serviceGateway,
        versionOneAuth: versionOneAuth,
        assetName: "Request",
        fields: [
            {
                name: 'RequestedBy',
                label: 'Requested By',
                required: true,
                autofocus: 'autofocus',
                placeholder: 'Your name',
                def: ''
            }
            ,{
                name: 'Name',
                required: true,
                placeholder: 'Brief request title',
                label: 'Title',
                autofocus: '',
                def: ''
            }
            ,{
                name: 'Priority',
                required: true,
                label: 'Priority',
                def: '', // TODO: handle this meaningfully
                type: 'select',
                assetName: 'RequestPriority'
            }
            ,{
                name: 'Description',
                label: 'Description',
                placeholder: 'Give enough detail to aid follow-up conversations',
                required: false,
                autofocus: '',
                def: '',
                type: 'textarea',
                height: 200
            }
        ]
    };
    var editor = new VersionOneAssetEditor(options);
});
    </script>
</head>    
<body>

<div data-role="page" id="list">
    <div data-role="header" data-position="fixed" style="text-align:center; padding-top:5px" data-theme="a">
        VersionOne Requestor
        <div>
            <fieldset class="ui-grid-a">
                <div class="ui-block-a"><a href="#" data-role="button" data-icon="arrow-r" id="refreshList" data-theme="e">Refresh List</a></div>
                <div class="ui-block-b"><a href="#detail" class="new" data-role="button" data-icon="plus" data-theme="e">New</a></div>
            </fieldset>
        </div>
    </div>
    
    <div data-role="content" class="sideGradient">
        <ul data-role="listview" data-filter="true" data-inset="true" id="assets" data-theme="e">
        </ul>
    </div>    
</div>

<div data-role="page" id="detail"> 
    <div data-role="header" data-position="fixed" style="text-align:center; padding-top:5px" data-theme="a">
        VersionOne Requestor
        <div>
            <fieldset class="ui-grid-a">
                <div class="ui-block-a"><a href="#list" data-role="button" data-icon="arrow-r" data-theme="e">List</a></div>
                <div class="ui-block-b"><a href="#" data-role="button" class="new" data-icon="plus" data-theme="e">New</a></div>
            </fieldset>
        </div>
    </div>

    <div data-role="content" class="sideGradient">      
        <div id="assetFormDiv">
            <form id="assetForm"></form> 
        </div>
            
    </div>

    <div data-role="footer" data-theme="a" data-position="fixed">
        <fieldset class="ui-grid-a">
            <div class="ui-block-a">
                <a href="#" data-role="button" id="save" data-icon="plus" data-mini="true" data-theme="b">Save</a>
            </div>
            <div class="ui-block-b">
                <a href="#" data-role="button" id="saveAndNew" data-icon="plus" data-mini="true" data-theme="b">Save and New</a>
            </div>        
        </fieldset>
    </div>    
</div>​

<div data-role="page" id="blank" data-theme="b">  

</div>

<script id="fieldsTemplate" type="text/x-jquery-tmpl">
    <div id="fields">        
        {{for fields}}
            <label for="{{:name}}">{{:label}}: </label>
            <div>            
            {{if type === "textarea" }}
                <textarea id="{{:name}}" class="inputField" {{if required == true}}placeholder="Required" required{{else}}placeholder="{{:placeholder}} (optional)"{{/if}} />
            {{else type === "select" }}
                <select class="selectField inputField" data-required="false" name="{{:name}}" id="{{:name}}" data-assetName="{{:assetName}}" data-rel="{{:name}}"></select>
            {{else}}
                <input type="text" {{:autofocus}} value="{{:def}}" id="{{:name}}" class="inputField" {{if required == true}}placeholder="{{:placeholder}} (required)" required{{else}}placeholder="{{:placeholder}} (optional)"{{/if}} />
            {{/if}}
            </div>
            <div>&nbsp;</div>
        {{/for}}
    </div>
</script>
        
<script id="assetItemTemplate" type="text/x-jquery-tmpl">
    <a class='assetItem' data-assetid='{{:_links.self.id}}' data-href='{{:_links.self.href}}' href='#'>
        <span>{{:Name}}</span>
        {{if RequestedBy}}<span style="font-size:80%">by {{:RequestedBy}}</span>{{/if}}
    </a>
</script>

</body>
</html>